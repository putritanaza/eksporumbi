SELECT
  a.hs, a.uraian_hs,
SUM(CASE WHEN a.bulan = '01' AND a.tahun = 2020 THEN a.nilai ELSE 0 END) AS nilai_2020_01,
SUM(CASE WHEN a.bulan = '02' AND a.tahun = 2020 THEN a.nilai ELSE 0 END) AS nilai_2020_02,
SUM(CASE WHEN a.bulan = '03' AND a.tahun = 2020 THEN a.nilai ELSE 0 END) AS nilai_2020_03,
SUM(CASE WHEN a.bulan = '04' AND a.tahun = 2020 THEN a.nilai ELSE 0 END) AS nilai_2020_04,
SUM(CASE WHEN a.bulan = '05' AND a.tahun = 2020 THEN a.nilai ELSE 0 END) AS nilai_2020_05,
SUM(CASE WHEN a.bulan = '06' AND a.tahun = 2020 THEN a.nilai ELSE 0 END) AS nilai_2020_06,
SUM(CASE WHEN a.bulan = '07' AND a.tahun = 2020 THEN a.nilai ELSE 0 END) AS nilai_2020_07,
SUM(CASE WHEN a.bulan = '08' AND a.tahun = 2020 THEN a.nilai ELSE 0 END) AS nilai_2020_08,
SUM(CASE WHEN a.bulan = '09' AND a.tahun = 2020 THEN a.nilai ELSE 0 END) AS nilai_2020_09,
SUM(CASE WHEN a.bulan = '10' AND a.tahun = 2020 THEN a.nilai ELSE 0 END) AS nilai_2020_10,
SUM(CASE WHEN a.bulan = '11' AND a.tahun = 2020 THEN a.nilai ELSE 0 END) AS nilai_2020_11,
SUM(CASE WHEN a.bulan = '12' AND a.tahun = 2020 THEN a.nilai ELSE 0 END) AS nilai_2020_12,

-- VOLUME
SUM(CASE WHEN a.bulan = '01' AND a.tahun = 2020 THEN a.volume ELSE 0 END) AS volume_2020_01,
SUM(CASE WHEN a.bulan = '02' AND a.tahun = 2020 THEN a.volume ELSE 0 END) AS volume_2020_02,
SUM(CASE WHEN a.bulan = '03' AND a.tahun = 2020 THEN a.volume ELSE 0 END) AS volume_2020_03,
SUM(CASE WHEN a.bulan = '04' AND a.tahun = 2020 THEN a.volume ELSE 0 END) AS volume_2020_04,
SUM(CASE WHEN a.bulan = '05' AND a.tahun = 2020 THEN a.volume ELSE 0 END) AS volume_2020_05,
SUM(CASE WHEN a.bulan = '06' AND a.tahun = 2020 THEN a.volume ELSE 0 END) AS volume_2020_06,
SUM(CASE WHEN a.bulan = '07' AND a.tahun = 2020 THEN a.volume ELSE 0 END) AS volume_2020_07,
SUM(CASE WHEN a.bulan = '08' AND a.tahun = 2020 THEN a.volume ELSE 0 END) AS volume_2020_08,
SUM(CASE WHEN a.bulan = '09' AND a.tahun = 2020 THEN a.volume ELSE 0 END) AS volume_2020_09,
SUM(CASE WHEN a.bulan = '10' AND a.tahun = 2020 THEN a.volume ELSE 0 END) AS volume_2020_10,
SUM(CASE WHEN a.bulan = '11' AND a.tahun = 2020 THEN a.volume ELSE 0 END) AS volume_2020_11,
SUM(CASE WHEN a.bulan = '12' AND a.tahun = 2020 THEN a.volume ELSE 0 END) AS volume_2020_12
FROM (
  SELECT
    TO_CHAR(t1.tahun, 'MM') AS bulan,
    DATE_PART('YEAR', t1.tahun) AS tahun,
    CONCAT(TO_CHAR(t1.tahun, 'MM'), '-', DATE_PART('YEAR', t1.tahun)) AS bulan_tahun,
    t3.uraian AS nama_prop,
    t2.sektor_name,
    t2.subsektor_name,
    t2.hs,
    t2.uraian_hs,
    SUM(t1.cifhsusd) AS nilai, 
		SUM(t1.netwths) AS volume
  FROM public.imp_2022 t1
  LEFT JOIN public.master_hs2022 t2 ON t1.hs = t2.hs
  LEFT JOIN public.master_propinsi t3 ON t1.kd_prop = t3.kd_prop
	WHERE 
	t2.hs IN ('81011000',
'81019400',
'81019600',
'81019700',
'81019910',
'81019990',
'81021000',
'81029400',
'81029500',
'81029600',
'81029700',
'81029900',
'81032000',
'81033000',
'81039100',
'81039900',
'81041100',
'81041900',
'81042000',
'81043000',
'81049000',
'81052010',
'81052090',
'81053000',
'81059000',
'81082000',
'81083000',
'81089000',
'81092100',
'81092900',
'81093100',
'81093900',
'81099100',
'81099900',
'81101000',
'81102000',
'81109000',
'81110010',
'81110090',
'81121200',
'81121300',
'81121900',
'81122100',
'81122200',
'81122900',
'81123100',
'81123900',
'79011100',
'79011200',
'79012000',
'79020000',
'79031000',
'79039000',
'79040000',
'79050040',
'79050090',
'79070030',
'79070040',
'79070091',
'79070092',
'79070093',
'79070099',
'72011000',
'72012000',
'72015000',
'72021100',
'72021900',
'72022100',
'72022900',
'72023000',
'72024100',
'72024900',
'72025000',
'72026000',
'72027000',
'72028000',
'72029100',
'72029200',
'72029300',
'72029900',
'72031000',
'72039000',
'72041000',
'72042100',
'72042900',
'72043000',
'72044100',
'72044900',
'72045000',
'72051000',
'72052100',
'72052900',
'72061010',
'72061090',
'72069000',
'72071100',
'72071210',
'72071290',
'72071900',
'72072010',
'72072021',
'72072029',
'72072091',
'72072092',
'72072099',
'72081000',
'72082500',
'72082600',
'72082711',
'72082719',
'72082791',
'72082799',
'72083600',
'72083700',
'72083800',
'72083910',
'72083920',
'72083930',
'72083940',
'72083990',
'72084000',
'72085100',
'72085200',
'72085300',
'72085410',
'72085490',
'72089010',
'72089020',
'72089090',
'72091500',
'72091610',
'72091690',
'72091710',
'72091790',
'72091810',
'72091891',
'72091899',
'72092500',
'72092610',
'72092690',
'72092710',
'72092790',
'72092810',
'72092890',
'72099010',
'72099090',
'72101110',
'72101190',
'72101210',
'72101290',
'72102010',
'72102090',
'72103011',
'72103012',
'72103019',
'72103091',
'72103099',
'72104111',
'72104112',
'72104119',
'72104191',
'72104199',
'72104911',
'72104914',
'72104915',
'72104916',
'72104917',
'72104918',
'72104919',
'72104991',
'72104999',
'72105000',
'72106111',
'72106112',
'72106119',
'72106191',
'72106192',
'72106199',
'72106911',
'72106919',
'72106991',
'72106999',
'72107012',
'72107013',
'72107019',
'72107021',
'72107029',
'72107091',
'72107099',
'72109010',
'72109090',
'72111312',
'72111313',
'72111314',
'72111319',
'72111392',
'72111393',
'72111399',
'72111414',
'72111415',
'72111416',
'72111417',
'72111419',
'72111494',
'72111495',
'72111499',
'72111913',
'72111914',
'72111919',
'72111991',
'72111999',
'72112310',
'72112320',
'72112330',
'72112390',
'72112910',
'72112920',
'72112930',
'72112990',
'72119011',
'72119012',
'72119013',
'72119014',
'72119019',
'72119091',
'72119099',
'72121011',
'72121014',
'72121019',
'72121094',
'72121099',
'72122010',
'72122020',
'72122090',
'72123011',
'72123012',
'72123013',
'72123014',
'72123019',
'72123090',
'72124011',
'72124012',
'72124013',
'72124014',
'72124019',
'72124091',
'72124099',
'72125014',
'72125019',
'72125023',
'72125024',
'72125029',
'72125093',
'72125094',
'72125099',
'72126011',
'72126012',
'72126019',
'72126091',
'72126099',
'72131010',
'72131090',
'72132000',
'72139110',
'72139120',
'72139130',
'72139190',
'72139910',
'72139920',
'72139990',
'72141011',
'72141019',
'72141021',
'72141029',
'72142031',
'72142039',
'72142041',
'72142049',
'72142051',
'72142059',
'72142061',
'72142069',
'72143010',
'72143090',
'72149111',
'72149112',
'72149119',
'72149120',
'72149911',
'72149919',
'72149991',
'72149992',
'72149993',
'72149999',
'72151010',
'72151090',
'72155010',
'72155091',
'72155099',
'72159010',
'72159091',
'72159099',
'72161000',
'72162110',
'72162190',
'72162200',
'72163110',
'72163190',
'72163210',
'72163290',
'72163311',
'72163319',
'72163390',
'72164010',
'72164090',
'72165011',
'72165019',
'72165091',
'72165099',
'72166100',
'72166900',
'72169110',
'72169190',
'72169900',
'72171010',
'72171022',
'72171029',
'72171032',
'72171033',
'72171039',
'72172010',
'72172020',
'72172091',
'72172099',
'72173011',
'72173019',
'72173020',
'72173033',
'72173034',
'72173035',
'72173039',
'72179010',
'72179090',
'72181000',
'72189100',
'72189900',
'72191100',
'72191200',
'72191300',
'72191400',
'72192100',
'72192200',
'72192300',
'72192400',
'72193100',
'72193200',
'72193300',
'72193400',
'72193500',
'72199000',
'72201110',
'72201190',
'72201210',
'72201290',
'72202010',
'72202090',
'72209010',
'72209090',
'72210000',
'72221100',
'72221900',
'72222010',
'72222090',
'72223010',
'72223090',
'72224010',
'72224090',
'72230010',
'72230090',
'72241000',
'72249000',
'72251100',
'72251900',
'72253010',
'72253090',
'72254010',
'72254090',
'72255010',
'72255090',
'72259110',
'72259190',
'72259210',
'72259220',
'72259290',
'72259910',
'72259990',
'72261110',
'72261190',
'72261910',
'72261990',
'72262010',
'72262090',
'72269110',
'72269190',
'72269210',
'72269290',
'72269911',
'72269919',
'72269991',
'72269999',
'72271000',
'72272000',
'72279010',
'72279090',
'72281010',
'72281090',
'72282011',
'72282019',
'72282091',
'72282099',
'72283010',
'72283090',
'72284010',
'72284090',
'72285010',
'72285090',
'72286010',
'72286090',
'72287010',
'72287090',
'72288011',
'72288019',
'72288090',
'72292000',
'72299021',
'72299029',
'72299030',
'72299091',
'72299099',
'81072000',
'81073000',
'81079000',
'28041000',
'28042100',
'28042900',
'28043000',
'28044000',
'28045000',
'28046100',
'28046900',
'28047000',
'28048000',
'28049000',
'25111000',
'28164000',
'28273910',
'28273990',
'28332700',
'28366000',
'28053000',
'28461000',
'28469000',
'28369200',
'28252000',
'28369100',
'28453000',
'29043300',
'85065000',
'85076031',
'85076032',
'85076033',
'85076039',
'85076090',
'25041000',
'38011000',
'38012000',
'38019000',
'68151010',
'28100010',
'28452000',
'29037700',
'28011000',
'28433000',
'71129100',
'71081100',
'71081210',
'71081290',
'71081300',
'71082000',
'25291010',
'25291090',
'28121200',
'28121300',
'28121400',
'28444200',
'71103900',
'26219010',
'28152000',
'28342100',
'28352400',
'28364000',
'28416100',
'31043000',
'29043400',
'31042000',
'25070000',
'25210000',
'26206000',
'28054000',
'28521010',
'28521020',
'28529010',
'28529020',
'85063000',
'75011000',
'75012000',
'75030000',
'75040000',
'75051100',
'75051200',
'75052100',
'75052200',
'75061000',
'75062000',
'75071100',
'75071200',
'75072000',
'75081000',
'75089030',
'75089050',
'75089090',
'26040000',
'26151000',
'26159000',
'71104110',
'71104190',
'71102110',
'71102190',
'71141100',
'71181010',
'85064000',
'26161000',
'71131110',
'71131190',
'71061000',
'71069100',
'71069200',
'71129200',
'71151000',
'25051000',
'28112920',
'28121500',
'80011000',
'80012000',
'80020000',
'80030010',
'80030090',
'80070020',
'80070030',
'80070040',
'80070091',
'80070092',
'80070093',
'80070099',
'74010010',
'74010020',
'74020010',
'74020090',
'74031100',
'74031200',
'74031300',
'74031900',
'74032100',
'74032200',
'74032900',
'74040000',
'74050000',
'74061000',
'74062000',
'74071030',
'74071041',
'74071049',
'74072100',
'74072900',
'74081120',
'74081130',
'74081190',
'74081910',
'74081990',
'74082100',
'74082200',
'74082910',
'74082990',
'74091100',
'74091900',
'74092100',
'74092900',
'74093100',
'74093900',
'74094000',
'74099000',
'74101110',
'74101190',
'74101200',
'74102100',
'74102200',
'74111000',
'74112100',
'74112200',
'74112900',
'74121000',
'74122020',
'74122091',
'74122099',
'74130011',
'74130019',
'74130091',
'74130099',
'74151010',
'74151020',
'74151090',
'74152100',
'74152900',
'74153310',
'74153320',
'74153900',
'74181010',
'74181030',
'74181090',
'74182000',
'74192010',
'74192020',
'74192090',
'74198010',
'74198021',
'74198029',
'74198030',
'74198040',
'74198050',
'74198060',
'74198070',
'74198080',
'74198090',
'76011000',
'76012000',
'76020000',
'76031000',
'76032010',
'76032020',
'76041010',
'76041090',
'76042110',
'76042120',
'76042190',
'76042910',
'76042930',
'76042990',
'76051100',
'76051910',
'76051990',
'76052100',
'76052910',
'76052990',
'76061110',
'76061190',
'76061220',
'76061232',
'76061233',
'76061234',
'76061235',
'76061239',
'76061290',
'76069100',
'76069200',
'76071100',
'76071900',
'76072010',
'76072091',
'76072099',
'76081000',
'76082000',
'71103110',
'71103190',
'27011100',
'27011210',
'27011290',
'27011900',
'27021000',
'27149010'
)
  GROUP BY
    TO_CHAR(t1.tahun, 'MM'),
    DATE_PART('YEAR', t1.tahun),
    t3.uraian,
    t2.sektor_name,
    t2.subsektor_name,
    t2.hs,
    t2.uraian_hs
) a
GROUP BY a.hs, a.uraian_hs
